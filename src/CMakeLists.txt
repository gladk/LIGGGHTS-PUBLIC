FILE(GLOB SRC_FILES_SRC "*.cpp")
SET(SRC_FILES ${SRC_FILES_SRC})

FILE(GLOB SRC_FILES_HEAD "*.h")

FOREACH(SUB_DIR_ADD ${MODULES_PACKAGE} ${MODULES_USER})
 MESSAGE("SUB_DIR_ADD: ${SUB_DIR_ADD}")
 FILE(GLOB SRC_FILES_ADD "${SUB_DIR_ADD}/*.cpp")
 INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/src/${SUB_DIR_ADD})
 SET(SRC_FILES ${SRC_FILES} ${SRC_FILES_ADD})
ENDFOREACH(SUB_DIR_ADD ${MODULES_PACKAGE} ${MODULES_USER})


#======================================================
IF (USERPATH)
  SET(CMAKE_SKIP_BUILD_RPATH FALSE)
  SET(CMAKE_BUILD_WITH_INSTALL_RPATH FALSE)
  SET(CMAKE_INSTALL_RPATH "${CMAKE_INSTALL_PREFIX}/lib/${LIB_SUFFIX}/")
  SET(CMAKE_INSTALL_RPATH_USE_LINK_PATH TRUE)
ENDIF (USERPATH)
#======================================================

FILE(GLOB to_remove main.cpp)
LIST(REMOVE_ITEM SRC_FILES ${to_remove})

ADD_LIBRARY(libliggghts SHARED ${SRC_FILES})
SET_TARGET_PROPERTIES(libliggghts PROPERTIES 
  OUTPUT_NAME "liggghts${SUFFIX}"
  SOVERSION ${VERSION})

IF(JPEG_FOUND)
  TARGET_LINK_LIBRARIES(libliggghts ${JPEG_LIBRARIES})
ENDIF(JPEG_FOUND)

IF(VTK_FOUND)
  TARGET_LINK_LIBRARIES(libliggghts vtkHybrid)
ENDIF(VTK_FOUND)

INSTALL(TARGETS libliggghts DESTINATION "lib/${LIB_SUFFIX}/")
#======================================================

ADD_EXECUTABLE(liggghts main.cpp)
SET_TARGET_PROPERTIES(liggghts PROPERTIES OUTPUT_NAME "liggghts${SUFFIX}")
TARGET_LINK_LIBRARIES(liggghts libliggghts)

INSTALL(TARGETS liggghts DESTINATION "bin/")

#======================================================

INSTALL(FILES ${SRC_FILES_HEAD} DESTINATION "include/liggghts${SUFFIX}/")
#======================================================

